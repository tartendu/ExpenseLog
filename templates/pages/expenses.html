{% extends "base.html" %}

{% block title %}Expenses - Expense Manager{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard_modern.css') }}">
{% endblock %}

{% block content %}
<!-- Top Header Bar -->
<div class="top-header-bar">
    <div class="header-left">
        <h1 class="page-title">Manage Expenses</h1>
    </div>
    <div class="header-right">
        <div class="search-box">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="search-icon">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
            </svg>
            <input type="text" placeholder="Search expenses..." />
        </div>
        <button class="header-icon-btn notification-btn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
            </svg>
            <span class="notification-badge">3</span>
        </button>
        <div class="header-user-info">
            <div class="header-user-avatar">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                </svg>
            </div>
            <div class="header-user-details">
                <p class="header-user-name">{{ session.get('email', 'User')[:20] }}</p>
                <p class="header-user-role">Account</p>
            </div>
        </div>
    </div>
</div>

<div class="modern-dashboard">
    <div class="dashboard-header">
        <div>
            <h2 class="dashboard-title">Track and organize all your expenses</h2>
        </div>
    </div>

    <div class="dashboard-content-grid">
        <div class="content-card" style="grid-column: span 2;">
            <div class="card-header">
                <h3>All Expenses</h3>
                <div class="filter-section">
                    <input type="text" id="searchExpenses" placeholder="Search expenses..." class="search-input">
                    <select id="filterCategory" class="filter-select">
                        <option value="">All Categories</option>
                        <option value="Food">Food</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Petrol">Petrol</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Bills">Bills</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Education">Education</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
            </div>
            <div id="expensesList" class="expenses-list">
                <p class="loading">Loading expenses...</p>
            </div>
        </div>

        <div class="content-card">
            <div class="card-header">
                <h3>Add New Expense</h3>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="header-icon">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
            </div>
            <form id="expenseForm" class="quick-form">
                <div class="form-group-modern">
                    <label for="amount">Amount (₹)</label>
                    <input type="number" id="amount" step="0.01" required placeholder="0.00">
                </div>

                <div class="form-group-modern">
                    <label for="date">Date</label>
                    <input type="date" id="date" required>
                </div>

                <div class="form-group-modern">
                    <label for="category">Category</label>
                    <select id="category" required>
                        <option value="">Select Category</option>
                        <option value="Food">Food</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Petrol">Petrol</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Bills">Bills</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Education">Education</option>
                        <option value="Other">Other</option>
                        <option value="custom">+ Add Custom Category</option>
                    </select>
                    <input type="text" id="customCategory" style="display: none; margin-top: 0.5rem;" placeholder="Enter custom category name" class="custom-category-input">
                </div>

                <div class="form-group-modern">
                    <label for="paymentMethod">Payment Method</label>
                    <select id="paymentMethod" required>
                        <option value="">Select Payment Method</option>
                        <option value="Cash">Cash</option>
                        <option value="Credit Card">Credit Card</option>
                        <option value="Debit Card">Debit Card</option>
                        <option value="UPI">UPI</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                    </select>
                </div>

                <div class="form-group-modern">
                    <label for="notes">Notes (Optional)</label>
                    <textarea id="notes" rows="3" placeholder="Add any additional details..."></textarea>
                </div>

                <button type="submit" class="btn-modern btn-primary-modern">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="btn-icon">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    Add Expense
                </button>
            </form>
        </div>
    </div>
</div>

<div id="editModal" class="modal">
    <div class="modal-content">
        <span class="modal-close">&times;</span>
        <h2>Edit Expense</h2>
        <form id="editExpenseForm">
            <input type="hidden" id="editExpenseId">

            <div class="form-row">
                <div class="form-group">
                    <label for="editAmount">Amount (₹)</label>
                    <input type="number" id="editAmount" step="0.01" required>
                </div>

                <div class="form-group">
                    <label for="editDate">Date</label>
                    <input type="date" id="editDate" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="editCategory">Category</label>
                    <select id="editCategory" required>
                        <option value="Food">Food</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Bills">Bills</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Education">Education</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="editPaymentMethod">Payment Method</label>
                    <select id="editPaymentMethod" required>
                        <option value="Cash">Cash</option>
                        <option value="Credit Card">Credit Card</option>
                        <option value="Debit Card">Debit Card</option>
                        <option value="UPI">UPI</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="editNotes">Notes</label>
                <textarea id="editNotes" rows="3"></textarea>
            </div>

            <button type="submit" class="btn btn-primary btn-block">Update Expense</button>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/expenses.js') }}"></script>
{% endblock %}
